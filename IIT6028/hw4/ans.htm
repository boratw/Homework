<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:"맑은 고딕";
	panose-1:2 11 5 3 2 0 0 2 0 4;}
@font-face
	{font-family:바탕체;
	panose-1:2 3 6 9 0 1 1 1 1 1;}
@font-face
	{font-family:"\@맑은 고딕";
	panose-1:2 11 5 3 2 0 0 2 0 4;}
@font-face
	{font-family:"\@바탕체";
	panose-1:2 3 6 9 0 1 1 1 1 1;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:8.0pt;
	margin-left:0cm;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:107%;
	text-autospace:none;
	word-break:break-hangul;
	font-size:10.0pt;
	font-family:"맑은 고딕";}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{mso-style-link:"머리글 Char";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:8.0pt;
	margin-left:0cm;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:107%;
	layout-grid-mode:char;
	text-autospace:none;
	word-break:break-hangul;
	font-size:10.0pt;
	font-family:"맑은 고딕";}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-link:"바닥글 Char";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:8.0pt;
	margin-left:0cm;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:107%;
	layout-grid-mode:char;
	text-autospace:none;
	word-break:break-hangul;
	font-size:10.0pt;
	font-family:"맑은 고딕";}
span.MsoPlaceholderText
	{color:gray;}
span.Char
	{mso-style-name:"머리글 Char";
	mso-style-link:머리글;}
span.Char0
	{mso-style-name:"바닥글 Char";
	mso-style-link:바닥글;}
.MsoChpDefault
	{font-family:"맑은 고딕";}
.MsoPapDefault
	{margin-bottom:8.0pt;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:107%;}
 /* Page Definitions */
 @page WordSection1
	{size:595.3pt 841.9pt;
	margin:3.0cm 72.0pt 72.0pt 72.0pt;}
div.WordSection1
	{page:WordSection1;}
-->
</style>

</head>

<body lang=KO>

<div class=WordSection1>

<p class=MsoNormal><b><span lang=EN-US style='font-size:16.0pt;line-height:
107%'>Q1. HDR IMAGING</span></b><b><span lang=EN-US style='font-size:12.0pt;
line-height:107%'> </span></b></p>

<p class=MsoNormal><b><span lang=EN-US style='font-size:12.0pt;line-height:
107%'>Description</span></b></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:107%'>Dave
Coffin</span><span style='font-size:12.0pt;line-height:107%'>의 <span
lang=EN-US>dcraw </span>프로그램의 소스코드를 받아 컴파일하여 사용하였다<span lang=EN-US>.</span></span></p>

<p class=MsoNormal><span lang=EN-US><img width=493 height=19 id="그림 30"
src="ans.files/image001.png"></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>사용한 파라미터는 다음과
같다<span lang=EN-US>.</span></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:107%'>-o
1 : </span><span style='font-size:12.0pt;line-height:107%'>출력물의 색공간을 <span
lang=EN-US>sRGB</span>로 한다<span lang=EN-US>.</span></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:107%'>-w
: white balancing</span><span style='font-size:12.0pt;line-height:107%'>을 수행한다<span
lang=EN-US>.</span></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:107%'>-q
3 : </span><span style='font-size:12.0pt;line-height:107%'>최대한 퀄리티가 높은 방법으로 <span
lang=EN-US>interpolation</span>을 수행한다<span lang=EN-US>.</span></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:107%'>-6
: 16bit color</span><span style='font-size:12.0pt;line-height:107%'>로 출력한다<span
lang=EN-US>.</span></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:107%'>-W
: </span><span style='font-size:12.0pt;line-height:107%'>이미지를 자동으로 밝게 하지 않는다<span
lang=EN-US>.</span></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:107%'>-T
: </span><span style='font-size:12.0pt;line-height:107%'>출력물을 <span lang=EN-US>tiff</span>로
한다<span lang=EN-US>.</span></span></p>

<p class=MsoNormal><b><span lang=EN-US style='font-size:12.0pt;line-height:
107%'>Result</span></b></p>

<p class=MsoNormal><span lang=EN-US><img width=903 height=180 id="그림 31"
src="ans.files/image002.png"></span></p>

<p class=MsoNormal><b><span lang=EN-US style='font-size:16.0pt;line-height:
107%'>Q2. LINEARIZE RENDERED IMAGES</span></b><b><span lang=EN-US
style='font-size:12.0pt;line-height:107%'> </span></b></p>

<p class=MsoNormal><b><span lang=EN-US style='font-size:12.0pt;line-height:
107%'>Description</span></b></p>

<p class=MsoNormal><span lang=EN-US><img width=926 height=66 id="그림 13"
src="ans.files/image003.png"></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>주어진 공식을 보면 이
공식은 <span lang=EN-US>pixel</span>의 위치와는 <span lang=EN-US>independent</span>한 식임을
알 수 있다<span lang=EN-US>. </span>따라서 픽셀의 일부를 샘플링하여 실행 속도를 높였다<span lang=EN-US>.</span></span></p>

<p class=MsoNormal><span
lang=EN-US style='font-size:10.0pt;line-height:107%;font-family:"맑은 고딕";
position:relative;top:7.5pt'><img width=71 height=30
src="ans.files/image004.png"></span><span style='font-size:12.0pt;line-height:
107%'>가 한 픽셀에서는 상수라는 점에서<span lang=EN-US>, </span></span><span
lang=EN-US style='font-size:10.0pt;line-height:107%;font-family:"맑은 고딕";
position:relative;top:8.5pt'><img width=425 height=32
src="ans.files/image005.png"></span><span lang=EN-US style='font-size:16.0pt;
line-height:107%'>&nbsp;</span><span style='font-size:12.0pt;line-height:107%'>이라는
<span lang=EN-US>L</span>과 상관없는 식을 만들 수 있다<span lang=EN-US>.</span></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>다음으로 </span><span
lang=EN-US style='font-size:10.0pt;line-height:107%;font-family:"맑은 고딕";
position:relative;top:8.5pt'><img width=21 height=32
src="ans.files/image006.png"></span><span style='font-size:12.0pt;line-height:
107%'>에서만 <span lang=EN-US>1</span>이고 나머지는 <span lang=EN-US>0</span>인<span
lang=EN-US> 256-D </span>벡터 </span><span
lang=EN-US style='font-size:10.0pt;line-height:107%;font-family:"맑은 고딕";
position:relative;top:8.5pt'><img width=27 height=32
src="ans.files/image007.png"></span><span style='font-size:12.0pt;line-height:
107%'>를 정의하면<span lang=EN-US>, </span></span><span
lang=EN-US style='font-size:10.0pt;line-height:107%;font-family:"맑은 고딕";
position:relative;top:8.5pt'><img width=51 height=32
src="ans.files/image008.png"></span><span lang=EN-US style='font-size:16.0pt;
line-height:107%'>&nbsp;= </span><span
lang=EN-US style='font-size:10.0pt;line-height:107%;font-family:"맑은 고딕";
position:relative;top:8.5pt'><img width=55 height=32
src="ans.files/image009.png"></span><span lang=EN-US style='font-size:16.0pt;
line-height:107%'>&nbsp;</span><span style='font-size:12.0pt;line-height:107%'>로
적을 수 있고 이를 펼치면 하나의 픽셀에 대하여</span></p>

<p class=MsoNormal><span
lang=EN-US style='font-size:10.0pt;line-height:107%;font-family:"맑은 고딕"'><img
width=405 height=130 src="ans.files/image010.png"></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>라는 식을 만들 수 있다<span
lang=EN-US>. </span>이 벡터의 <span lang=EN-US>1</span>차 미분은 모두 <span lang=EN-US>1</span>이다<span
lang=EN-US>. weight</span>까지 고려하면 하나의 픽셀에 대하여</span></p>

<p class=MsoNormal><span
lang=EN-US style='font-size:10.0pt;line-height:107%;font-family:"맑은 고딕"'><img width=622 height=130
src="ans.files/image011.png"></span><span lang=EN-US style='font-size:16.0pt;
line-height:107%'>&nbsp;</span><span
lang=EN-US style='font-size:10.0pt;line-height:107%;font-family:"맑은 고딕"'><img width=328 height=145
src="ans.files/image012.png"></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>을 근사적으로 얻을 수
있다<span lang=EN-US>.</span></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>이제 </span><span
lang=EN-US style='font-size:10.0pt;line-height:107%;font-family:"맑은 고딕";
position:relative;top:7.5pt'><img width=93 height=30
src="ans.files/image013.png"></span><span style='font-size:12.0pt;line-height:
107%'>형태의 식을 얻었으므로 샘플링한 모든 픽셀과 라플라시안 매트릭스까지 더하여<span lang=EN-US> least-squares
optimization</span>을 풀면 된다<span lang=EN-US>.</span></span><b><span lang=EN-US
style='font-size:16.0pt;line-height:107%'> </span></b></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>이때 모든 등식을 미분
형태로만 구성하였으므로 <span lang=EN-US>constant shift</span>가 생길 수 있다<span lang=EN-US>. </span>따라서
<span lang=EN-US>g(255) = log(255)</span>로 고정하였다<span lang=EN-US>.</span></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>사용한 <span
lang=EN-US>weighting function</span>은 다음과 같다<span lang=EN-US>.</span></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=200 valign=top style='width:150.25pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>uniform</span></p>
  </td>
  <td width=200 valign=top style='width:150.25pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>tent</span></p>
  </td>
  <td width=200 valign=top style='width:150.3pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>gaussian</span></p>
  </td>
 </tr>
 <tr>
  <td width=200 valign=top style='width:150.25pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US><img width=171
  height=170 id="그림 11" src="ans.files/image014.jpg"></span></p>
  </td>
  <td width=200 valign=top style='width:150.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US><img width=170
  height=170 id="그림 10" src="ans.files/image015.jpg"></span></p>
  </td>
  <td width=200 valign=top style='width:150.3pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US><img width=172
  height=170 id="그림 9" src="ans.files/image016.jpg"></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:107%'>&nbsp;</span></p>

<p class=MsoNormal><b><span lang=EN-US style='font-size:12.0pt;line-height:
107%'>Code</span></b></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='background:#FFF2CC;border-collapse:collapse;border:none'>
 <tr style='height:90.6pt'>
  <td width=707 valign=top style='width:538.25pt;border:solid windowtext 1.0pt;
  padding:5.4pt 5.4pt 5.4pt 5.4pt;height:90.6pt'>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:forestgreen'>% Load image as reduced
  size for reduce memory usage.</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>image_origin = {};</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:blue'>for</span><span lang=EN-US
  style='font-family:"Courier New";color:black'> i = 1:16</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  image_origin{end+1} = imread(strcat(</span><span lang=EN-US style='font-family:
  "Courier New";color:#A020F0'>'res_stack\\exposure'</span><span lang=EN-US
  style='font-family:"Courier New";color:black'>,int2str(i),</span><span
  lang=EN-US style='font-family:"Courier New";color:#A020F0'>'.tiff'</span><span
  lang=EN-US style='font-family:"Courier New";color:black'>));</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;
  image_origin{end} = im2uint8(imresize(image_origin{end}, 0.125));</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:blue'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:blue'>for</span><span lang=EN-US
  style='font-family:"Courier New";color:black'> chan = 1:3</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; </span><span
  lang=EN-US style='font-family:"Courier New";color:forestgreen'>% sample 2000
  pointe</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; samples =
  zeros(32000, 1, </span><span lang=EN-US style='font-family:"Courier New";
  color:#A020F0'>'uint8'</span><span lang=EN-US style='font-family:"Courier New";
  color:black'>);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; </span><span
  lang=EN-US style='font-family:"Courier New";color:blue'>for</span><span
  lang=EN-US style='font-family:"Courier New";color:black'> i = 0:1999</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  x = randi(750);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  y = randi(500);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>for</span><span
  lang=EN-US style='font-family:"Courier New";color:black'> f = 1:16</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  samples(i * 16 + f) = image_origin{f}(y, x, chan);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; </span><span
  lang=EN-US style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; lambda =
  1.0;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; </span><span
  lang=EN-US style='font-family:"Courier New";color:forestgreen'>% construct G
  matrix and the differance value b</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; getg =
  zeros(32256, 256);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; b =
  zeros(30255, 1);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; </span><span
  lang=EN-US style='font-family:"Courier New";color:blue'>for</span><span
  lang=EN-US style='font-family:"Courier New";color:black'> i = 0:1999</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>for</span><span
  lang=EN-US style='font-family:"Courier New";color:black'> j = 1:15</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  getg((i * 16 + j), samples((i * 16 + j)) + 1) = 1;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  b(i * 15 + j) = 0.693147180 * getw(samples(i * 16 + j + 1));</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  getg((i * 16 + 16), samples((i * 16 + 16)) + 1) = 1;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; </span><span
  lang=EN-US style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:blue'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; </span><span
  lang=EN-US style='font-family:"Courier New";color:forestgreen'>% append
  original g for create laplacian</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; </span><span
  lang=EN-US style='font-family:"Courier New";color:blue'>for</span><span
  lang=EN-US style='font-family:"Courier New";color:black'> i = 1:256</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  getg(32000 + i, i) = 1;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; </span><span
  lang=EN-US style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:blue'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; </span><span
  lang=EN-US style='font-family:"Courier New";color:forestgreen'>% set constant
  (for preserve 255)</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; b(30255) =
  log(255);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; </span><span
  lang=EN-US style='font-family:"Courier New";color:forestgreen'>% set first
  derivative matrix </span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; diff =
  zeros(30255, 32256);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; </span><span
  lang=EN-US style='font-family:"Courier New";color:blue'>for</span><span
  lang=EN-US style='font-family:"Courier New";color:black'> i = 0:1999</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>for</span><span
  lang=EN-US style='font-family:"Courier New";color:black'> j = 1:15</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  diff(i * 15 + j, i * 16 + j) = -b(i * 15 + j);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  diff(i * 15 + j, i * 16 + j + 1) = b(i * 15 + j);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; </span><span
  lang=EN-US style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; </span><span
  lang=EN-US style='font-family:"Courier New";color:forestgreen'>% set second
  derivative (laplacian) matrix </span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; </span><span
  lang=EN-US style='font-family:"Courier New";color:blue'>for</span><span
  lang=EN-US style='font-family:"Courier New";color:black'> i = 1:254</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  diff(30000 + i, 32000 + i) =&nbsp; 1 * lambda;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  diff(30000 + i, 32000 + i + 1) = -2 * 1 * lambda;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  diff(30000 + i, 32000 + i + 2) = 1 * lambda;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; </span><span
  lang=EN-US style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; </span><span
  lang=EN-US style='font-family:"Courier New";color:forestgreen'>% set constant
  (for preserve 255)</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; diff(30255,
  32256) = 1;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; A = diff *
  getg;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; g(chan, :) =
  A \ b;</span><span lang=EN-US style='font-size:12.0pt;font-family:"Courier New"'>
  </span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:blue'>end</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><b><span lang=EN-US style='font-size:12.0pt;line-height:
107%'>&nbsp;</span></b></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='background:#FFF2CC;border-collapse:collapse;border:none'>
 <tr style='height:90.6pt'>
  <td width=707 valign=top style='width:538.25pt;border:solid windowtext 1.0pt;
  padding:5.4pt 5.4pt 5.4pt 5.4pt;height:90.6pt'>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:blue'>function</span><span lang=EN-US
  style='font-family:"Courier New";color:black'> ret = getw(v)</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; </span><span
  lang=EN-US style='font-family:"Courier New";color:blue'>if</span><span
  lang=EN-US style='font-family:"Courier New";color:black'>((v == 0) || (v ==
  255))</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  ret = 0;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; </span><span
  lang=EN-US style='font-family:"Courier New";color:blue'>else</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:forestgreen'>%select
  weighting function and uncomment one</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:forestgreen'>%ret
  = exp(-((double(v) - 128.) ^ 2) / 4096);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:forestgreen'>%ret
  = (128. - abs(double(v) - 128.)) / 128.;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  ret = 1;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp; </span><span
  lang=EN-US style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:blue'>end</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><b><span lang=EN-US style='font-size:12.0pt;line-height:
107%'>&nbsp;</span></b></p>

<p class=MsoNormal><b><span lang=EN-US style='font-size:12.0pt;line-height:
107%'>Result </span></b></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=241 valign=top style='width:184.3pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>w
  = uniform</span></p>
  </td>
  <td width=234 valign=top style='width:184.3pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>w
  = tent</span></p>
  </td>
  <td width=237 valign=top style='width:184.3pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>w
  = gaussian</span></p>
  </td>
 </tr>
 <tr>
  <td width=241 valign=top style='width:184.3pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US><img width=227
  height=239 id="그림 32" src="ans.files/image017.png"></span></p>
  </td>
  <td width=234 valign=top style='width:184.3pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US><img width=220
  height=228 id="그림 34" src="ans.files/image018.png"></span></p>
  </td>
  <td width=237 valign=top style='width:184.3pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US><img width=223
  height=228 id="그림 35" src="ans.files/image019.png"></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><b><span lang=EN-US style='font-size:12.0pt;line-height:
107%'>&nbsp;</span></b></p>

<p class=MsoNormal><b><span lang=EN-US style='font-size:16.0pt;line-height:
107%'>Q2. MERGE EXPOSURE STACK INTO HDR IMAGE</span></b><b><span lang=EN-US
style='font-size:12.0pt;line-height:107%'> </span></b><b><span lang=EN-US
style='font-size:16.0pt;line-height:107%'>&amp;</span></b><b><span lang=EN-US
style='font-size:12.0pt;line-height:107%'> </span></b><b><span lang=EN-US
style='font-size:16.0pt;line-height:107%'>Q3. EVALUATION</span></b></p>

<p class=MsoNormal><b><span lang=EN-US style='font-size:12.0pt;line-height:
107%'>Description </span></b></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:107%'>linear
merging</span><span style='font-size:12.0pt;line-height:107%'>공식으로</span><span
lang=EN-US style='font-size:10.0pt;line-height:107%;font-family:"맑은 고딕"'><img
width=270 height=67 src="ans.files/image020.png"></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:107%'>logarithmic
merging </span><span style='font-size:12.0pt;line-height:107%'>공식으로 </span><span
lang=EN-US style='font-size:10.0pt;line-height:107%;font-family:"맑은 고딕"'><img
width=392 height=67 src="ans.files/image021.png"></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>을 사용하였다<span
lang=EN-US>.</span></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>또한 <span
lang=EN-US>Evaluation</span>을 위해 원본 이미지에 있는</span></p>

<p class=MsoNormal><span lang=EN-US><img width=259 height=213 id="그림 58"
src="ans.files/image022.jpg"></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:107%'>6</span><span
style='font-size:12.0pt;line-height:107%'>개 점의<span lang=EN-US> luminacity</span>를
<span lang=EN-US>XYZ </span>색공간에서 비교하여 얼마나 <span lang=EN-US>linear</span>한지 확인하는
방법을 사용하였다<span lang=EN-US>.</span></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>다만 색공간 변환 과정에서</span></p>

<p class=MsoNormal><span lang=EN-US><img width=444 height=126 id="그림 1"
src="ans.files/image023.png"></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>오류가 발생하여 <span
lang=EN-US>srgb</span>로 비교하였다<span lang=EN-US>.</span></span></p>

<p class=MsoNormal><b><span lang=EN-US style='font-size:12.0pt;line-height:
107%'>Code</span></b></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='background:#FFF2CC;border-collapse:collapse;border:none'>
 <tr style='height:90.6pt'>
  <td width=707 valign=top style='width:538.25pt;border:solid windowtext 1.0pt;
  padding:5.4pt 5.4pt 5.4pt 5.4pt;height:90.6pt'>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:blue'>for</span><span lang=EN-US
  style='font-family:"Courier New";color:black'> chan = 1:3</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; m = 0;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; </span><span
  lang=EN-US style='font-family:"Courier New";color:blue'>for</span><span
  lang=EN-US style='font-family:"Courier New";color:black'> i = 1:500</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>for</span><span
  lang=EN-US style='font-family:"Courier New";color:black'> j = 1:750</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  wsum = 0;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  v = 0;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>for</span><span
  lang=EN-US style='font-family:"Courier New";color:black'> f = 1:16</span><span
  lang=EN-US style='font-size:12.0pt;font-family:"Courier New"'> </span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:forestgreen'>%
  Descripted below</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:forestgreen'>%
  /--</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:forestgreen'>%
  --</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:forestgreen'>%
  --</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:forestgreen'>%
  --/</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  wsum = wsum + getw(image_jpg{f}(i, j, chan));</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  &nbsp;</span><span lang=EN-US style='font-family:"Courier New";color:blue'>if</span><span
  lang=EN-US style='font-family:"Courier New";color:black'> wsum ~= 0</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  v = v / wsum;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:forestgreen'>%
  For Logarithm merging</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:forestgreen'>%
  /--</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  v = exp(v);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:forestgreen'>%
  --/</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  image_res(i, j, chan) = v;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>if</span><span
  lang=EN-US style='font-family:"Courier New";color:black'> (m &lt; v)</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  m = v;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; </span><span
  lang=EN-US style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; image_res(:,
  :, chan) = image_res(:, :, chan) ./ m;</span><span lang=EN-US
  style='font-size:12.0pt;font-family:"Courier New"'> </span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:blue'>end</span><span lang=EN-US
  style='font-family:"Courier New";color:black'> </span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-size:12.0pt;font-family:"Courier New"'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:forestgreen'>% Image Evaluation</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>image_xyz = rgb2xyz(image_res, </span><span
  lang=EN-US style='font-family:"Courier New";color:#A020F0'>'ColorSpace'</span><span
  lang=EN-US style='font-family:"Courier New";color:black'>, </span><span
  lang=EN-US style='font-family:"Courier New";color:#A020F0'>'srgb'</span><span
  lang=EN-US style='font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>lum = zeros(6, 1);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:blue'>for</span><span lang=EN-US
  style='font-family:"Courier New";color:black'> f = 1:6</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; </span><span
  lang=EN-US style='font-family:"Courier New";color:blue'>for</span><span
  lang=EN-US style='font-family:"Courier New";color:black'> i = fp(f, 1) - 3 :
  fp(f, 1) + 3</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>for</span><span
  lang=EN-US style='font-family:"Courier New";color:black'> j = fp(f, 2) - 3 :
  fp(f, 2) + 3</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  lum(f) = lum(f) + image_xyz(j, i, 2);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; </span><span
  lang=EN-US style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; lum(f) =
  log(lum(f) / 49);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>lumerr = 0;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:blue'>for</span><span lang=EN-US
  style='font-family:"Courier New";color:black'> f = 2:5</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; lumerr =
  lumerr + ((lum(1) + (lum(6) - lum(1)) * (f-1) / 5) - lum(f)) ^ 2;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:blue'>end</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><b><span lang=EN-US style='font-size:12.0pt;line-height:
107%'>For Raw, Linear merging</span></b></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='background:#FFF2CC;border-collapse:collapse;border:none'>
 <tr style='height:26.0pt'>
  <td width=707 valign=top style='width:535.95pt;border:solid windowtext 1.0pt;
  padding:5.4pt 5.4pt 5.4pt 5.4pt;height:26.0pt'>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  v = v + getw(image_tiff{f}(i, j, chan)) * </span><span lang=EN-US
  style='font-family:"Courier New";color:blue'>...</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  double(image_tiff{f}(i, j, chan)) * 2 ^ (-f);</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><b><span lang=EN-US style='font-size:12.0pt;line-height:
107%'>For Raw Lorarithm merging</span></b></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='background:#FFF2CC;border-collapse:collapse;border:none'>
 <tr style='height:26.0pt'>
  <td width=707 valign=top style='width:535.95pt;border:solid windowtext 1.0pt;
  padding:5.4pt 5.4pt 5.4pt 5.4pt;height:26.0pt'>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>if</span><span
  lang=EN-US style='font-family:"Courier New";color:black'>(image_tiff{f}(i, j,
  chan) &gt; 0)</span><span lang=EN-US style='font-size:12.0pt;font-family:
  "Courier New"'> </span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  v = v + getw(image_tiff{f}(i, j, chan)) * </span><span lang=EN-US
  style='font-family:"Courier New";color:blue'>...</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  (log(double(image_tiff{f}(i, j, chan)))&nbsp; - 0.69314718 * f);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>end</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><b><span lang=EN-US style='font-size:12.0pt;line-height:
107%'>For Rendered, Linear merging</span></b></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='background:#FFF2CC;border-collapse:collapse;border:none'>
 <tr style='height:26.0pt'>
  <td width=707 valign=top style='width:535.95pt;border:solid windowtext 1.0pt;
  padding:5.4pt 5.4pt 5.4pt 5.4pt;height:26.0pt'>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  v = v + getw(image_jpg{f}(i, j, chan)) * </span><span lang=EN-US
  style='font-family:"Courier New";color:blue'>...</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  exp(g(chan, image_jpg{f}(i, j, chan) + 1)) * 2 ^ (-f);</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><b><span lang=EN-US style='font-size:12.0pt;line-height:
107%'>For Rendered, Lorarithm merging</span></b></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='background:#FFF2CC;border-collapse:collapse;border:none'>
 <tr style='height:26.0pt'>
  <td width=707 valign=top style='width:535.95pt;border:solid windowtext 1.0pt;
  padding:5.4pt 5.4pt 5.4pt 5.4pt;height:26.0pt'>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  v = v + getw(image_jpg{f}(i, j, chan)) * </span><span lang=EN-US
  style='font-family:"Courier New";color:blue'>...</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  (g(chan, image_jpg{f}(i, j, chan) + 1) - 0.69314718 * f);</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><b><span lang=EN-US style='font-size:12.0pt;line-height:
107%'>Result</span></b></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=85 valign=top style='width:63.4pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>&nbsp;</span></p>
  </td>
  <td width=242 valign=top style='width:184.3pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>x5</span></p>
  </td>
  <td width=240 valign=top style='width:5.0cm;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>x125</span></p>
  </td>
  <td width=242 valign=top style='width:181.6pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>x625</span></p>
  </td>
  <td width=145 valign=top style='width:108.95pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>&nbsp;</span></p>
  </td>
 </tr>
 <tr style='height:4.0cm'>
  <td width=85 valign=top style='width:63.4pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:4.0cm'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>raw</span></p>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>uniform</span></p>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>linear</span></p>
  </td>
  <td width=242 valign=top style='width:184.3pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:4.0cm'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=228 height=150 src="ans.files/image024.jpg"></span></p>
  </td>
  <td width=240 valign=top style='width:5.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:4.0cm'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=226 height=150 src="ans.files/image025.jpg"></span></p>
  </td>
  <td width=242 valign=top style='width:181.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:4.0cm'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=228 height=150 src="ans.files/image026.jpg"></span></p>
  </td>
  <td width=145 valign=top style='width:108.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:4.0cm'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US><img width=130
  height=87 id="그림 49" src="ans.files/image027.jpg"></span></p>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>0.03</span></p>
  </td>
 </tr>
 <tr>
  <td width=85 valign=top style='width:63.4pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>raw</span></p>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>uniform</span></p>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>logarithm</span></p>
  </td>
  <td width=242 valign=top style='width:184.3pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=226 height=150 src="ans.files/image028.jpg"></span></p>
  </td>
  <td width=240 valign=top style='width:5.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=226 height=150 src="ans.files/image029.jpg"></span></p>
  </td>
  <td width=242 valign=top style='width:181.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=226 height=150 src="ans.files/image030.jpg"></span></p>
  </td>
  <td width=145 valign=top style='width:108.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US><img width=130
  height=90 id="그림 50" src="ans.files/image031.jpg"></span></p>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>0.0167</span></p>
  </td>
 </tr>
 <tr>
  <td width=85 valign=top style='width:63.4pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>raw</span></p>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>gaussian
  </span></p>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>linear</span></p>
  </td>
  <td width=242 valign=top style='width:184.3pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=226 height=150 src="ans.files/image032.jpg"></span></p>
  </td>
  <td width=240 valign=top style='width:5.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=226 height=150 src="ans.files/image033.jpg"></span></p>
  </td>
  <td width=242 valign=top style='width:181.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=228 height=150 src="ans.files/image034.jpg"></span></p>
  </td>
  <td width=145 valign=top style='width:108.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US><img width=128
  height=89 id="그림 52" src="ans.files/image035.jpg"></span></p>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>0.1133</span></p>
  </td>
 </tr>
 <tr>
  <td width=85 valign=top style='width:63.4pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>raw</span></p>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>gaussian</span></p>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>logarithm</span></p>
  </td>
  <td width=242 valign=top style='width:184.3pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=226 height=150 src="ans.files/image036.jpg"></span></p>
  </td>
  <td width=240 valign=top style='width:5.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=226 height=150 src="ans.files/image037.jpg"></span></p>
  </td>
  <td width=242 valign=top style='width:181.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=226 height=150 src="ans.files/image038.jpg"></span></p>
  </td>
  <td width=145 valign=top style='width:108.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US><img width=128
  height=90 id="그림 51" src="ans.files/image039.jpg"></span></p>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>0.0325</span></p>
  </td>
 </tr>
 <tr>
  <td width=85 valign=top style='width:63.4pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>rendered</span></p>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>uniform</span></p>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>linear</span></p>
  </td>
  <td width=242 valign=top style='width:184.3pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=226 height=150 src="ans.files/image040.jpg"></span></p>
  </td>
  <td width=240 valign=top style='width:5.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=226 height=150 src="ans.files/image041.jpg"></span></p>
  </td>
  <td width=242 valign=top style='width:181.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=226 height=150 src="ans.files/image042.jpg"></span></p>
  </td>
  <td width=145 valign=top style='width:108.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US><img width=129
  height=80 id="그림 57" src="ans.files/image043.jpg"></span></p>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>0.0467</span></p>
  </td>
 </tr>
 <tr>
  <td width=85 valign=top style='width:63.4pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>rendered</span></p>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>uniform</span></p>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>logarithm</span></p>
  </td>
  <td width=242 valign=top style='width:184.3pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=226 height=150 src="ans.files/image044.jpg"></span></p>
  </td>
  <td width=240 valign=top style='width:5.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=226 height=150 src="ans.files/image045.jpg"></span></p>
  </td>
  <td width=242 valign=top style='width:181.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=226 height=150 src="ans.files/image046.jpg"></span></p>
  </td>
  <td width=145 valign=top style='width:108.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US><img width=127
  height=91 id="그림 59" src="ans.files/image047.jpg"></span></p>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>0.0053</span></p>
  </td>
 </tr>
 <tr style='height:99.2pt'>
  <td width=85 valign=top style='width:63.4pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:99.2pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>rendered</span></p>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>gaussian</span></p>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>linear</span></p>
  </td>
  <td width=242 valign=top style='width:184.3pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:99.2pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=226 height=150 src="ans.files/image048.jpg"></span></p>
  </td>
  <td width=240 valign=top style='width:5.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:99.2pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=226 height=150 src="ans.files/image049.jpg"></span></p>
  </td>
  <td width=242 valign=top style='width:181.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:99.2pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=226 height=150 src="ans.files/image050.jpg"></span></p>
  </td>
  <td width=145 valign=top style='width:108.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:99.2pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US><img width=130
  height=84 id="그림 60" src="ans.files/image051.jpg"></span></p>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>0.0510</span></p>
  </td>
 </tr>
 <tr>
  <td width=85 valign=top style='width:63.4pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>rendered</span></p>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>gaussian</span></p>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>logarithm</span></p>
  </td>
  <td width=242 valign=top style='width:184.3pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=226 height=150 src="ans.files/image052.jpg"></span></p>
  </td>
  <td width=240 valign=top style='width:5.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=226 height=150 src="ans.files/image053.jpg"></span></p>
  </td>
  <td width=242 valign=top style='width:181.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=226 height=150 src="ans.files/image054.jpg"></span></p>
  </td>
  <td width=145 valign=top style='width:108.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US><img width=131
  height=93 id="그림 56" src="ans.files/image055.jpg"></span></p>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>0.0488</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><b><span lang=EN-US style='font-size:12.0pt;line-height:
107%'>&nbsp;</span></b></p>

<p class=MsoNormal><b><span lang=EN-US style='font-size:12.0pt;line-height:
107%'>&nbsp;</span></b></p>

<p class=MsoNormal><b><span lang=EN-US style='font-size:16.0pt;line-height:
107%'>Q4. PHOTOGRAPHIC TONEMAPPING</span></b><b><span lang=EN-US
style='font-size:12.0pt;line-height:107%'> </span></b></p>

<p class=MsoNormal><b><span lang=EN-US style='font-size:12.0pt;line-height:
107%'>Description </span></b></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>우선 <span
lang=EN-US>Tonemapping</span>을 위한 <span lang=EN-US>hdr image</span>는 위의 결과중에 가장
나았던 <span lang=EN-US>raw </span>파일<span lang=EN-US>, gaussian weight, logarithm
merging </span>이미지를 사용하였다<span lang=EN-US>.</span></span></p>

<p class=MsoNormal><span lang=EN-US><img width=479 height=176 id="그림 4"
src="ans.files/image056.png"></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>공식을 그대로 적용하여
<span lang=EN-US>Tonemapping</span>된 픽셀의 밝기를 구했다<span lang=EN-US>.</span></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>을 사용하였다<span
lang=EN-US>. </span></span></p>

<p class=MsoNormal><b><span lang=EN-US style='font-size:12.0pt;line-height:
107%'>Code</span></b></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='background:#FFF2CC;border-collapse:collapse;border:none'>
 <tr style='height:90.6pt'>
  <td width=707 valign=top style='width:538.25pt;border:solid windowtext 1.0pt;
  padding:5.4pt 5.4pt 5.4pt 5.4pt;height:90.6pt'>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>hdr = hdrread(</span><span
  lang=EN-US style='font-family:"Courier New";color:#A020F0'>'raw_gaussian_linear.hdr'</span><span
  lang=EN-US style='font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:forestgreen'>% Constants</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>K = 0.5;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>B = 0.95;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>image_res = zeros(500, 750, 3);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:forestgreen'>% RGB Tonemappig</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:blue'>for</span><span lang=EN-US
  style='font-family:"Courier New";color:black'> c = 1:3</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; I_org =
  hdr(:, :, c);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; I_m = exp( 1
  / (500*750) * sum(log(I_org(:) + 1e-15)) );</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; I_tilde =
  I_org * K / I_m;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; I_white = B
  * max(I_tilde(:));</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; </span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; I_tone =
  I_tilde .* ( I_tilde ./ (I_white ^ 2)&nbsp; + 1) ./ (I_tilde + 1);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; image_res(:,
  :, c) = I_tone(:, :);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:blue'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>imwrite(image_res, </span><span
  lang=EN-US style='font-family:"Courier New";color:#A020F0'>'RGB_K_0.5_B_0.95.png'</span><span
  lang=EN-US style='font-family:"Courier New";color:black'>)</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:forestgreen'>% Get xyY image</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>hdr_xyz = rgb2xyz(hdr, </span><span
  lang=EN-US style='font-family:"Courier New";color:#A020F0'>'ColorSpace'</span><span
  lang=EN-US style='font-family:"Courier New";color:black'>, </span><span
  lang=EN-US style='font-family:"Courier New";color:#A020F0'>'srgb'</span><span
  lang=EN-US style='font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>hdr_xyY = zeros(500, 750, 3);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>hdr_xyY(:, :, 1) = hdr_xyz(:, :
  ,1) ./ (hdr_xyz(:, : ,1) + hdr_xyz(:, : ,2) + hdr_xyz(:, : ,3));</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>hdr_xyY(:, :, 2) = hdr_xyz(:, :
  ,2) ./ (hdr_xyz(:, : ,1) + hdr_xyz(:, : ,2) + hdr_xyz(:, : ,3));</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>hdr_xyY(:, :, 3) = hdr_xyz(:, :
  ,2);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:forestgreen'>% luminance Tonemapping</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>I_org = hdr_xyY(:, :, 3);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>I_m = exp( 1 / (500*750) *
  sum(log(I_org(:) + 1e-15)) );</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>I_tilde = I_org * K / I_m;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>I_white = B * max(I_tilde(:));</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>I_tone = I_tilde .* ( I_tilde
  ./ (I_white ^ 2) + 1) ./ (I_tilde + 1);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:forestgreen'>% Back to RGB image</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>image_res(:, :, 1) = I_tone(:,
  :) .* hdr_xyY(:, :, 1) ./ hdr_xyY(:, :, 2);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>image_res(:, :, 2) = I_tone(:,
  :);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>image_res(:, :, 3) = I_tone(:,
  :) .* (1 - hdr_xyY(:, :, 1) - hdr_xyY(:, :, 2)) ./ hdr_xyY(:, :, 2);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>image_res = xyz2rgb(image_res);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>imwrite(image_res, </span><span
  lang=EN-US style='font-family:"Courier New";color:#A020F0'>'Lum_K_0.5_B_0.95.png'</span><span
  lang=EN-US style='font-family:"Courier New";color:black'>)</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><b><span lang=EN-US style='font-size:12.0pt;line-height:
107%'>Result</span></b><span lang=EN-US style='font-size:12.0pt;line-height:
107%'> </span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:107%'>Change
K value ( B = 0.95 )</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:107%'>RGB
Tonemapping</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0 width=0
 style='width:807.6pt;border-collapse:collapse;border:none'>
 <tr>
  <td width=269 valign=top style='width:201.7pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>K
  = 0.05</span></p>
  </td>
  <td width=269 valign=top style='width:201.9pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>K
  = 0.15</span></p>
  </td>
  <td width=269 valign=top style='width:201.7pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>K
  = 0.35</span></p>
  </td>
  <td width=269 valign=top style='width:202.3pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>K
  = 0.5</span></p>
  </td>
 </tr>
 <tr>
  <td width=269 valign=top style='width:201.7pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=255 height=170 src="ans.files/image057.jpg"></span></p>
  </td>
  <td width=269 valign=top style='width:201.9pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=255 height=170 src="ans.files/image058.jpg"></span></p>
  </td>
  <td width=269 valign=top style='width:201.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=255 height=170 src="ans.files/image059.jpg"></span></p>
  </td>
  <td width=269 valign=top style='width:202.3pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=255 height=170 src="ans.files/image060.jpg"></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:107%'>Luminance
Tonemapping</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=269 valign=top style='width:201.7pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>K
  = 0.05</span></p>
  </td>
  <td width=269 valign=top style='width:201.7pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>K
  = 0.15</span></p>
  </td>
  <td width=269 valign=top style='width:201.7pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>K
  = 0.35</span></p>
  </td>
  <td width=269 valign=top style='width:201.7pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>K
  = 0.5</span></p>
  </td>
 </tr>
 <tr>
  <td width=269 valign=top style='width:201.7pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span lang=EN-US style='font-size:12.0pt'><img width=255 height=170
  src="ans.files/image061.jpg"></span></p>
  </td>
  <td width=269 valign=top style='width:201.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span lang=EN-US style='font-size:12.0pt'><img width=255 height=170
  src="ans.files/image062.jpg"></span></p>
  </td>
  <td width=269 valign=top style='width:201.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span lang=EN-US style='font-size:12.0pt'><img width=255 height=170
  src="ans.files/image063.jpg"></span></p>
  </td>
  <td width=269 valign=top style='width:201.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span lang=EN-US style='font-size:12.0pt'><img width=255 height=170
  src="ans.files/image064.jpg"></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:107%'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:107%'>Change
B value ( K = 0.35 ) </span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:107%'>RGB
Tonemapping</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=269 valign=top style='width:201.7pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>B
  = 0.001</span></p>
  </td>
  <td width=269 valign=top style='width:201.7pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>B
  = 0.01</span></p>
  </td>
  <td width=269 valign=top style='width:201.7pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>B
  = 0.1</span></p>
  </td>
  <td width=269 valign=top style='width:201.7pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>B
  = 100</span></p>
  </td>
 </tr>
 <tr>
  <td width=269 valign=top style='width:201.7pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span lang=EN-US style='font-size:12.0pt'><img width=255 height=170
  src="ans.files/image065.jpg"></span></p>
  </td>
  <td width=269 valign=top style='width:201.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span lang=EN-US style='font-size:12.0pt'><img width=255 height=170
  id="그림 27" src="ans.files/image066.jpg"></span></p>
  </td>
  <td width=269 valign=top style='width:201.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span lang=EN-US style='font-size:12.0pt'><img width=255 height=170
  id="그림 26" src="ans.files/image067.jpg"></span></p>
  </td>
  <td width=269 valign=top style='width:201.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span lang=EN-US style='font-size:12.0pt'><img width=255 height=170
  src="ans.files/image068.jpg"></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:107%'>Luminance
Tonemapping</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=269 valign=top style='width:202.05pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>B
  = 0.001</span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>B
  = 0.01</span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>B
  = 0.1</span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>B
  = 100</span></p>
  </td>
 </tr>
 <tr>
  <td width=269 valign=top style='width:202.05pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span lang=EN-US style='font-size:12.0pt'><img width=255 height=170
  src="ans.files/image069.jpg"></span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span lang=EN-US style='font-size:12.0pt'><img width=255 height=170
  id="그림 29" src="ans.files/image070.jpg"></span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span lang=EN-US style='font-size:12.0pt'><img width=255 height=170
  id="그림 28" src="ans.files/image071.jpg"></span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span lang=EN-US style='font-size:12.0pt'><img width=255 height=170
  src="ans.files/image072.jpg"></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><b><span lang=EN-US style='font-size:12.0pt;line-height:
107%'>&nbsp;</span></b></p>

<p class=MsoNormal><b><span lang=EN-US style='font-size:16.0pt;line-height:
107%'>Q5. TONEMAPPING USING BILATERAL FILTERING</span></b></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>우선 <span
lang=EN-US>Tonemapping</span>을 위한 <span lang=EN-US>hdr image</span>는 똑같이 <span
lang=EN-US>raw </span>파일<span lang=EN-US>, gaussian weight, logarithm merging </span>이미지를
사용하였다<span lang=EN-US>.</span></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:107%'>Bilateral
filter</span><span style='font-size:12.0pt;line-height:107%'>의 적용을 위해<span
lang=EN-US> Douglas Lanman</span>의<span lang=EN-US> implement</span>를 사용하였다<span
lang=EN-US>. </span>이는 <span lang=EN-US>Gaussian inflence function</span>을 사용하며<span
lang=EN-US>, filter size W</span>와 <span lang=EN-US>spartial domain </span>및 <span
lang=EN-US>intensity domain </span>각각의 필터의 표준편차<span lang=EN-US> sigma</span>를 파라미터로
갖는다<span lang=EN-US>.</span></span></p>

<p class=MsoNormal><b><span lang=EN-US style='font-size:12.0pt;line-height:
107%'>Code</span></b></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='background:#FFF2CC;border-collapse:collapse;border:none'>
 <tr style='height:90.6pt'>
  <td width=707 valign=top style='width:538.25pt;border:solid windowtext 1.0pt;
  padding:5.4pt 5.4pt 5.4pt 5.4pt;height:90.6pt'>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>hdr = hdrread(</span><span
  lang=EN-US style='font-family:"Courier New";color:#A020F0'>'raw_gaussian_logarithm.hdr'</span><span
  lang=EN-US style='font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:forestgreen'>% Constants</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>S = 0.3;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>W = 1.;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>sigma = [5., 1.0];</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>image_res = zeros(500, 750, 3);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:forestgreen'>% RGB Tonemappig</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:blue'>for</span><span lang=EN-US
  style='font-family:"Courier New";color:black'> c = 1:3</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; L_img =
  log(hdr(:, :, c));</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; B_img =
  bfilter2(L_img, W, sigma);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; D_img =
  L_img - B_img;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; B_img =
  (B_img - max(B_img(:))) .* S;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; </span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; I_tone =
  exp(D_img + B_img);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; image_res(:,
  :, c) = I_tone(:, :);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:blue'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>imwrite(image_res, </span><span
  lang=EN-US style='font-family:"Courier New";color:#A020F0'>'RGB_S_0.5_W_5_sigma_3_0.5.png'</span><span
  lang=EN-US style='font-family:"Courier New";color:black'>)</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:forestgreen'>% Get xyY image</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>hdr_xyz = rgb2xyz(hdr, </span><span
  lang=EN-US style='font-family:"Courier New";color:#A020F0'>'ColorSpace'</span><span
  lang=EN-US style='font-family:"Courier New";color:black'>, </span><span
  lang=EN-US style='font-family:"Courier New";color:#A020F0'>'srgb'</span><span
  lang=EN-US style='font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>hdr_xyY = zeros(500, 750, 3);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>hdr_xyY(:, :, 1) = hdr_xyz(:, :
  ,1) ./ (hdr_xyz(:, : ,1) + hdr_xyz(:, : ,2) + hdr_xyz(:, : ,3));</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>hdr_xyY(:, :, 2) = hdr_xyz(:, :
  ,2) ./ (hdr_xyz(:, : ,1) + hdr_xyz(:, : ,2) + hdr_xyz(:, : ,3));</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>hdr_xyY(:, :, 3) = hdr_xyz(:, :
  ,2);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:forestgreen'>% luminance Tonemapping</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>L_img = log(hdr_xyY(:, :, 3));</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>B_img = bfilter2(L_img, W,
  sigma);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>D_img = L_img - B_img;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>B_img = (B_img - max(B_img(:)))
  .* S;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>I_tone = exp(D_img + B_img);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:forestgreen'>% Back to RGB image</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>image_res(:, :, 1) = I_tone(:,
  :) .* hdr_xyY(:, :, 1) ./ hdr_xyY(:, :, 2);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>image_res(:, :, 2) = I_tone(:,
  :);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>image_res(:, :, 3) = I_tone(:,
  :) .* (1 - hdr_xyY(:, :, 1) - hdr_xyY(:, :, 2)) ./ hdr_xyY(:, :, 2);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>image_res = xyz2rgb(image_res);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>imwrite(image_res, </span><span
  lang=EN-US style='font-family:"Courier New";color:#A020F0'>'Lum_S_0.3_W_1_sigma_5_1.png'</span><span
  lang=EN-US style='font-family:"Courier New";color:black'>)</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><b><span lang=EN-US style='font-size:12.0pt;line-height:
107%'>Result</span></b></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:107%'>Change
S value </span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:107%'>RGB
Tonemapping (W = 5, s_sprtial = 3, s_intensity = 0.1)</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=269 valign=top style='width:202.05pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>S
  = 0.1</span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>S
  = 0.3</span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>S
  = 0.5</span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>S
  = 1</span></p>
  </td>
 </tr>
 <tr>
  <td width=269 valign=top style='width:202.05pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span lang=EN-US style='font-size:12.0pt'><img width=255 height=170
  src="ans.files/image073.jpg"></span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span lang=EN-US style='font-size:12.0pt'><img width=255 height=170
  src="ans.files/image074.jpg"></span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span lang=EN-US style='font-size:12.0pt'><img width=255 height=170
  src="ans.files/image075.jpg"></span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span lang=EN-US style='font-size:12.0pt'><img width=255 height=170
  src="ans.files/image076.jpg"></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:107%'>Luminance
Tonemapping (W = 5, s_sprtial = 3, s_intensity = 0.1)</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=269 valign=top style='width:202.05pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>S
  = 0.1</span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>S
  = 0.3</span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>S
  = 0.5</span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>S
  = 1</span></p>
  </td>
 </tr>
 <tr>
  <td width=269 valign=top style='width:202.05pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span lang=EN-US style='font-size:12.0pt'><img width=255 height=170
  src="ans.files/image077.jpg"></span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span lang=EN-US style='font-size:12.0pt'><img width=255 height=170
  src="ans.files/image078.jpg"></span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span lang=EN-US style='font-size:12.0pt'><img width=255 height=170
  src="ans.files/image079.jpg"></span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span lang=EN-US style='font-size:12.0pt'><img width=255 height=170
  src="ans.files/image080.jpg"></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:107%'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:107%'>Change
W value &nbsp;(S = 0.2, s_sprtial = 5, s_intensity = 1)</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:107%'>W</span><span
style='font-size:12.0pt;line-height:107%'>를 늘리자 연산 시간이 눈에 띄게 증가하였다<span
lang=EN-US>. </span></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=269 valign=top style='width:202.05pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>W
  = 1</span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>W
  = 5</span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>W
  = 10</span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>W
  = 20</span></p>
  </td>
 </tr>
 <tr>
  <td width=269 valign=top style='width:202.05pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>time
  : 2.1207s</span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>time
  : 2.6772s</span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>time
  : 4.9092s</span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>time
  : 9.5326s</span></p>
  </td>
 </tr>
 <tr>
  <td width=269 valign=top style='width:202.05pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span lang=EN-US style='font-size:12.0pt'><img width=255 height=170
  src="ans.files/image081.jpg"></span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span lang=EN-US style='font-size:12.0pt'><img width=255 height=170
  src="ans.files/image082.jpg"></span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span lang=EN-US style='font-size:12.0pt'><img width=255 height=170
  src="ans.files/image083.jpg"></span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span lang=EN-US style='font-size:12.0pt'><img width=255 height=170
  src="ans.files/image084.jpg"></span></p>
  </td>
 </tr>
 <tr>
  <td width=269 valign=top style='width:202.05pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=246 height=246 src="ans.files/image085.jpg"></span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=246 height=246 src="ans.files/image086.jpg"></span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=246 height=246 src="ans.files/image087.jpg"></span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=246 height=246 src="ans.files/image088.jpg"></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:107%'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:107%'>Change
s_intensity value &nbsp;(S = 0.2, W = 5, s_sprtial = 5)</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=269 valign=top style='width:202.05pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>s_intensity
  = 0.1</span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>s_intensity
  = 0.3</span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>s_intensity
  = 1</span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>s_intensity
  = 5</span></p>
  </td>
 </tr>
 <tr>
  <td width=269 valign=top style='width:202.05pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span lang=EN-US style='font-size:12.0pt'><img width=255 height=170
  src="ans.files/image089.jpg"></span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span lang=EN-US style='font-size:12.0pt'><img width=255 height=170
  src="ans.files/image090.jpg"></span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span lang=EN-US style='font-size:12.0pt'><img width=255 height=170
  src="ans.files/image091.jpg"></span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span lang=EN-US style='font-size:12.0pt'><img width=255 height=170
  src="ans.files/image092.jpg"></span></p>
  </td>
 </tr>
 <tr>
  <td width=269 valign=top style='width:202.05pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=246 height=246 src="ans.files/image093.jpg"></span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=246 height=246 src="ans.files/image094.jpg"></span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=246 height=246 src="ans.files/image095.jpg"></span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=246 height=246 src="ans.files/image096.jpg"></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:107%'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:107%'>Change
s_spartial value &nbsp;(S = 0.2, W = 5, s_intensity = 1)</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=269 valign=top style='width:202.05pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>s_spartial
  = 0.1</span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>s_spartial
  = 1</span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>s_spartial
  = 5</span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'>s_spartial
  = 20</span></p>
  </td>
 </tr>
 <tr>
  <td width=269 valign=top style='width:202.05pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span lang=EN-US style='font-size:12.0pt'><img width=255 height=170
  src="ans.files/image097.jpg"></span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span lang=EN-US style='font-size:12.0pt'><img width=255 height=170
  src="ans.files/image098.jpg"></span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span lang=EN-US style='font-size:12.0pt'><img width=255 height=170
  src="ans.files/image099.jpg"></span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
  normal'><span lang=EN-US style='font-size:12.0pt'><img width=255 height=170
  src="ans.files/image100.jpg"></span></p>
  </td>
 </tr>
 <tr>
  <td width=269 valign=top style='width:202.05pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=246 height=246 src="ans.files/image101.jpg"></span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=246 height=246 src="ans.files/image102.jpg"></span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=246 height=246 src="ans.files/image103.jpg"></span></p>
  </td>
  <td width=269 valign=top style='width:202.05pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=246 height=246 src="ans.files/image104.jpg"></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><b><span lang=EN-US style='font-size:12.0pt;line-height:
107%'>&nbsp;</span></b></p>

<p class=MsoNormal><b><span lang=EN-US style='font-size:16.0pt;line-height:
107%'>Q6. IMPLEMENT A DIFFERENT GRADIENT-DOMAIN PROCESSING ALGORITHM</span></b></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>기본적인 아이디어는 이미지의
각 영역에 <span lang=EN-US>scale factor</span>를 주어 <span lang=EN-US>gradient</span>를
더 많이 반영할 영역과 더 적게 반영할 영역을 나누는 것이다<span lang=EN-US>.</span></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>이후 <span
lang=EN-US>Poisson Equation</span>을 푸는데<span lang=EN-US>,</span></span></p>

<p class=MsoNormal><span lang=EN-US><img width=106 height=47 id="그림 2"
src="ans.files/image105.jpg"></span><span style='font-size:12.0pt;line-height:
107%'>에서<span lang=EN-US>, I</span>는 이미지가 되고 <span lang=EN-US>G</span>는 <span
lang=EN-US>scale</span>이 반영된 <span lang=EN-US>Gradient</span>가 된다<span
lang=EN-US>.</span></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:107%'>Gradient
Attenuation</span><span style='font-size:12.0pt;line-height:107%'>은 기본적으로 </span><span
lang=EN-US><img width=290 height=69 id="그림 3" src="ans.files/image106.jpg"></span><span
style='font-size:12.0pt;line-height:107%'>의 공식을 적용하여<span lang=EN-US> alpha</span>보다
작은 값은 크게<span lang=EN-US>, alpha</span>보다 큰 값은 작게 <span lang=EN-US>scailing</span>한다<span
lang=EN-US>.</span></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>위 함수의 <span
lang=EN-US>alpha = 0.1, beta = 0.9</span>에서의 그래프는 다음과 같다<span lang=EN-US>.</span></span></p>

<p class=MsoNormal><span lang=EN-US><img width=292 height=270 id="그림 5"
src="ans.files/image107.png"></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>이미지의 <span
lang=EN-US>Gaussian Pyramid</span>를 구한 후 아래층부터 <span lang=EN-US>scaling factor</span>를
구하여 <span lang=EN-US>upscaling</span>하고 다음 층의 <span lang=EN-US>scaling factor</span>를
곱하는 방식으로 전체 이미지의 <span lang=EN-US>scaling factor</span>를 구한다<span lang=EN-US>.</span></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>이 위 공식은 <span
lang=EN-US>gradient = 0</span>이면 정의되지 않으므로 <span lang=EN-US>gradient &lt;
0.0001</span>일 경우 <span lang=EN-US>3</span>을 대신 사용하도록 조정하였다<span lang=EN-US>.</span></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>결과적으로 우리 사진에서
다음 이미지를 얻을 수 있었다<span lang=EN-US>.</span></span></p>

<p class=MsoNormal><span lang=EN-US><img width=750 height=503 id="그림 6"
src="ans.files/image108.png"></span><span lang=EN-US style='font-size:12.0pt;
line-height:107%'>&nbsp;</span></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>이제 이미지의<span
lang=EN-US> G</span>에 위의 <span lang=EN-US>scailing factor</span>를 곱하고<span
lang=EN-US>, div G</span>를 구해<span lang=EN-US> poisson equation</span>을 풀면 결과가 나온다<span
lang=EN-US>. </span></span></p>

<p class=MsoNormal><b><span lang=EN-US style='font-size:12.0pt;line-height:
107%'>Code</span></b></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='background:#FFF2CC;border-collapse:collapse;border:none'>
 <tr style='height:90.6pt'>
  <td width=707 valign=top style='width:538.25pt;border:solid windowtext 1.0pt;
  padding:5.4pt 5.4pt 5.4pt 5.4pt;height:90.6pt'>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>hdr = hdrread(</span><span
  lang=EN-US style='font-family:"Courier New";color:#A020F0'>'raw_gaussian_logarithm.hdr'</span><span
  lang=EN-US style='font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>ALPHA = 0.1;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>BETA = 0.9;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>image_res = zeros(498, 748, 3);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:forestgreen'>% Get xyY image</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>hdr_xyz = rgb2xyz(hdr, </span><span
  lang=EN-US style='font-family:"Courier New";color:#A020F0'>'ColorSpace'</span><span
  lang=EN-US style='font-family:"Courier New";color:black'>, </span><span
  lang=EN-US style='font-family:"Courier New";color:#A020F0'>'srgb'</span><span
  lang=EN-US style='font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>hdr_xyY = zeros(500, 750, 3);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>hdr_xyY(:, :, 1) = hdr_xyz(:, :
  ,1) ./ (hdr_xyz(:, : ,1) + hdr_xyz(:, : ,2) + hdr_xyz(:, : ,3));</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>hdr_xyY(:, :, 2) = hdr_xyz(:, :
  ,2) ./ (hdr_xyz(:, : ,1) + hdr_xyz(:, : ,2) + hdr_xyz(:, : ,3));</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>hdr_xyY(:, :, 3) = hdr_xyz(:, :
  ,2);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:forestgreen'>% Gradiant Tonemapping</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>L_img = log(hdr_xyY(:, :, 3));</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:forestgreen'>% Make Gaussian Pyramid</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>L_Gaussian = {};</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>L_Gaussian{1} = L_img;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>[w, h] = size(L_img);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>i = 1;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:blue'>while</span><span lang=EN-US
  style='font-family:"Courier New";color:black'>((w &gt; 5) &amp;&amp; (h &gt;
  5))</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; x =
  imgaussfilt(L_Gaussian{i}, 2); </span><span lang=EN-US style='font-family:
  "Courier New";color:forestgreen'>% Gaussian Filtering</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; L_Gaussian{i
  + 1} = x(1:2:end, 1:2:end);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; [w, h] =
  size(L_Gaussian{i+1});</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; i = i + 1;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:blue'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:forestgreen'>%Make phi (Gradient scale
  factor)</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>phi = zeros(4, 6);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:blue'>for</span><span lang=EN-US
  style='font-family:"Courier New";color:black'> x = 1:4</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; </span><span
  lang=EN-US style='font-family:"Courier New";color:blue'>for</span><span
  lang=EN-US style='font-family:"Courier New";color:black'> y = 1:6</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>if</span><span
  lang=EN-US style='font-family:"Courier New";color:black'> x == 1</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  dif = (L_Gaussian{8}(x + 1, y) - L_Gaussian{8}(x, y)) ^ 2;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>elseif</span><span
  lang=EN-US style='font-family:"Courier New";color:black'> x == 4</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  dif = (L_Gaussian{8}(x, y) - L_Gaussian{8}(x - 1, y)) ^ 2;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>else</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  dif = (L_Gaussian{8}(x + 1, y) - L_Gaussian{8}(x - 1, y)) ^ 2;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;</span><span
  lang=EN-US style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>if</span><span
  lang=EN-US style='font-family:"Courier New";color:black'> y == 1</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  dif = dif + (L_Gaussian{8}(x, y + 1) - L_Gaussian{8}(x, y)) ^ 2;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>elseif</span><span
  lang=EN-US style='font-family:"Courier New";color:black'> y == 6</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  dif = dif + (L_Gaussian{8}(x, y) - L_Gaussian{8}(x, y - 1)) ^ 2;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>else</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  dif = dif + (L_Gaussian{8}(x, y + 1) - L_Gaussian{8}(x, y - 1)) ^ 2;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  dif = sqrt(dif) * (2^(-8));</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>if</span><span
  lang=EN-US style='font-family:"Courier New";color:black'> dif &lt; 0.000001</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  phi(x, y) = 3.;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>else</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  phi(x, y) = (dif / ALPHA) ^ (BETA - 1.);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; </span><span
  lang=EN-US style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:blue'>for</span><span lang=EN-US
  style='font-family:"Courier New";color:black'> i = 7:-1:1</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; phi =
  imresize(phi, 2, </span><span lang=EN-US style='font-family:"Courier New";
  color:#A020F0'>'bilinear'</span><span lang=EN-US style='font-family:"Courier New";
  color:black'>);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; [w, h] =
  size(L_Gaussian{i});</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; phi =
  phi(1:w, 1:h);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; </span><span
  lang=EN-US style='font-family:"Courier New";color:blue'>for</span><span
  lang=EN-US style='font-family:"Courier New";color:black'> x = 1:w</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>for</span><span
  lang=EN-US style='font-family:"Courier New";color:black'> y = 1:h</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>if</span><span
  lang=EN-US style='font-family:"Courier New";color:black'> x == 1</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  dif = (L_Gaussian{i}(x + 1, y) - L_Gaussian{i}(x, y)) ^ 2;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>elseif</span><span
  lang=EN-US style='font-family:"Courier New";color:black'> x == w</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  dif = (L_Gaussian{i}(x, y) - L_Gaussian{i}(x - 1, y)) ^ 2;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>else</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  dif = (L_Gaussian{i}(x + 1, y) - L_Gaussian{i}(x - 1, y)) ^ 2;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>if</span><span
  lang=EN-US style='font-family:"Courier New";color:black'> y == 1</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  dif = dif + (L_Gaussian{i}(x, y + 1) - L_Gaussian{i}(x, y)) ^ 2;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>elseif</span><span
  lang=EN-US style='font-family:"Courier New";color:black'> y == h</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  dif = dif + (L_Gaussian{i}(x, y) - L_Gaussian{i}(x, y - 1)) ^ 2;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>else</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  dif = dif + (L_Gaussian{i}(x, y + 1) - L_Gaussian{i}(x, y - 1)) ^ 2;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span
  lang=EN-US style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  dif = sqrt(dif) * (2^(-i));</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>if</span><span
  lang=EN-US style='font-family:"Courier New";color:black'> dif &lt; 0.000001</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  phi(x, y) = 3.;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>else</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  phi(x, y) = phi(x, y) * ((dif / ALPHA) ^ (-0.1));</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; </span><span
  lang=EN-US style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>im2var = zeros(498, 748, </span><span
  lang=EN-US style='font-family:"Courier New";color:#A020F0'>'uint32'</span><span
  lang=EN-US style='font-family:"Courier New";color:black'>);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>im2var(1:498*748) = 1:498*748;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:forestgreen'>% Make G with scale
  factor</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>G = zeros(499, 749, 2);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:blue'>for</span><span lang=EN-US
  style='font-family:"Courier New";color:black'> x = 1:499</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; </span><span
  lang=EN-US style='font-family:"Courier New";color:blue'>for</span><span
  lang=EN-US style='font-family:"Courier New";color:black'> y = 1:749</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  G(x, y, 1) = phi(x, y) * (L_img(x + 1, y) - L_img(x, y));</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  G(x, y, 2) = phi(x, y) * (L_img(x, y + 1) - L_img(x, y));</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; </span><span
  lang=EN-US style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:blue'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:forestgreen'>% Make divG</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>divG = zeros(498*748 + 1, 1);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:blue'>for</span><span lang=EN-US
  style='font-family:"Courier New";color:black'> x = 1:498</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; </span><span
  lang=EN-US style='font-family:"Courier New";color:blue'>for</span><span
  lang=EN-US style='font-family:"Courier New";color:black'> y = 1:748</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  divG(im2var(x,y)) = G(x+1, y+1, 1) - G(x, y+1, 1) + G(x+1, y+1, 2) - G(x+1,
  y, 2);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; </span><span
  lang=EN-US style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:forestgreen'>% Constant zero</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>divG(498*748 + 1) = 0.;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:forestgreen'>% Make Laplacian Matrix</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>W = sparse(498*748+1, 498*748);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:blue'>for</span><span lang=EN-US
  style='font-family:"Courier New";color:black'> x = 1 : 498</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; </span><span
  lang=EN-US style='font-family:"Courier New";color:blue'>for</span><span
  lang=EN-US style='font-family:"Courier New";color:black'> y = 1 : 748</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  i = 0;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>if</span><span
  lang=EN-US style='font-family:"Courier New";color:black'> x ~= 1</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  W( im2var(x,y), im2var(x-1,y)) = 1;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  i = i - 1;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>if</span><span
  lang=EN-US style='font-family:"Courier New";color:black'> x ~= 498</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  W( im2var(x,y), im2var(x+1,y)) = 1;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  i = i - 1;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>if</span><span
  lang=EN-US style='font-family:"Courier New";color:black'> y ~= 1</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  W( im2var(x,y), im2var(x,y-1) ) = 1;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  i = i - 1;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>if</span><span
  lang=EN-US style='font-family:"Courier New";color:black'> y ~= 748</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  W( im2var(x,y), im2var(x,y+1) ) = 1;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i
  = i - 1;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span lang=EN-US style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  W( im2var(x,y), im2var(x,y) ) = i;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;&nbsp;&nbsp; </span><span
  lang=EN-US style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:blue'>end</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:forestgreen'>% make center point to
  zero</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>W(498*748+1, im2var(250,375)) =
  1;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:forestgreen'>% solve equation</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>L_new = W \ divG;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:forestgreen'>% restore tone value</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>I_tone = zeros(498, 748);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>I_tone(:) = exp(L_new);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:forestgreen'>% Normalize</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>I_tone = (I_tone -
  min(I_tone(:))) / (max(I_tone(:)) - min(I_tone(:)));</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:forestgreen'>% Back to RGB image</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>image_res(:, :, 1) = I_tone(:,
  :) .* hdr_xyY(2:499, 2:749, 1) ./ hdr_xyY(2:499, 2:749, 2);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>image_res(:, :, 2) = I_tone(:,
  :);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>image_res(:, :, 3) = I_tone(:,
  :) .* (1 - hdr_xyY(2:499, 2:749, 1) - hdr_xyY(2:499, 2:749, 2)) ./
  hdr_xyY(2:499, 2:749, 2);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>&nbsp;</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>image_res = xyz2rgb(image_res);</span></p>
  <p class=MsoNormal align=left style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:left;line-height:normal;word-break:keep-all'><span lang=EN-US
  style='font-family:"Courier New";color:black'>imwrite(image_res, </span><span
  lang=EN-US style='font-family:"Courier New";color:#A020F0'>'Gradient_Tonemap_0.1_0.9.png'</span><span
  lang=EN-US style='font-family:"Courier New";color:black'>)</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><b><span lang=EN-US style='font-size:12.0pt;line-height:
107%'>Result</span></b></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>우선 이 코드를 돌린 결과
다음 이미지를 얻었다<span lang=EN-US>.</span></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:107%'><img
width=511 height=340 src="ans.files/image109.jpg"></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>원인은 <span
lang=EN-US>phi</span>의 값이 너무 컸다<span lang=EN-US>. </span></span></p>

<p class=MsoNormal><span lang=EN-US><img width=112 height=112 id="그림 7"
src="ans.files/image110.png"></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>따라서 <span
lang=EN-US>phi</span>를 <span lang=EN-US>maximum </span>값으로 나누어<span lang=EN-US>
[0, 1]</span>로 <span lang=EN-US>Normalize</span>한 후 코드를 돌린 결과 다음 이미지를 얻었다<span
lang=EN-US>.</span></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:107%'><img
width=511 height=340 src="ans.files/image111.jpg"></span></p>

<p class=MsoNormal><span style='font-size:12.0pt;line-height:107%'>이미지가 지나치게 밝아
이번엔 <span lang=EN-US>[0, 3]</span>으로 <span lang=EN-US>Normalize</span>한 결과는 다음과
같았다<span lang=EN-US>.</span></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:107%'><img
width=511 height=340 src="ans.files/image112.jpg">&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:107%'>&nbsp;[0,
5]</span><span style='font-size:12.0pt;line-height:107%'>로 <span lang=EN-US>Normalize</span>하면
다음과 같다<span lang=EN-US>.</span></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:107%'><img
width=511 height=340 id="그림 8" src="ans.files/image113.jpg"></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:107%'>Alpha</span><span
style='font-size:12.0pt;line-height:107%'>나 <span lang=EN-US>Beta </span>값은 크게 결과에
영향을 주지 않았다<span lang=EN-US>.</span></span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=297 valign=top style='width:150.25pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span style='font-size:12.0pt'>α<span
  lang=EN-US> = 0.001, </span>β<span lang=EN-US> = 0.9</span></span></p>
  </td>
  <td width=297 valign=top style='width:150.25pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span style='font-size:12.0pt'>α<span
  lang=EN-US> = 0.1, </span>β<span lang=EN-US> = 0.9</span></span></p>
  </td>
  <td width=297 valign=top style='width:150.3pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span style='font-size:12.0pt'>α<span
  lang=EN-US> = 0.5, </span>β<span lang=EN-US> = 0.9</span></span></p>
  </td>
 </tr>
 <tr>
  <td width=297 valign=top style='width:150.25pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=283 height=189 src="ans.files/image114.jpg"></span></p>
  </td>
  <td width=297 valign=top style='width:150.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=283 height=189 src="ans.files/image115.jpg"></span></p>
  </td>
  <td width=297 valign=top style='width:150.3pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=283 height=189 src="ans.files/image116.jpg"></span></p>
  </td>
 </tr>
 <tr>
  <td width=297 valign=top style='width:150.25pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span style='font-size:12.0pt'>α<span
  lang=EN-US> = 0.1, </span>β<span lang=EN-US> = 0.5</span></span></p>
  </td>
  <td width=297 valign=top style='width:150.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span style='font-size:12.0pt'>α<span
  lang=EN-US> = 0.1, </span>β<span lang=EN-US> = 0.9</span></span></p>
  </td>
  <td width=297 valign=top style='width:150.3pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span style='font-size:12.0pt'>α<span
  lang=EN-US> = 0.1, </span>β<span lang=EN-US> = 0.99</span></span></p>
  </td>
 </tr>
 <tr>
  <td width=297 valign=top style='width:150.25pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=283 height=189 src="ans.files/image117.jpg"></span></p>
  </td>
  <td width=297 valign=top style='width:150.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=283 height=189 src="ans.files/image118.jpg"></span></p>
  </td>
  <td width=297 valign=top style='width:150.3pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='margin-bottom:0cm;margin-bottom:.0001pt;
  text-align:center;line-height:normal'><span lang=EN-US style='font-size:12.0pt'><img
  width=283 height=189 src="ans.files/image119.jpg"></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US style='font-size:12.0pt;line-height:107%'>&nbsp;</span></p>

</div>

</body>

</html>
